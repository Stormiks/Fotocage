(function(e){function t(t){for(var r,a,i=t[0],u=t[1],c=t[2],l=0,d=[];l<i.length;l++)a=i[l],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&d.push(o[a][0]),o[a]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);m&&m(t);while(d.length)d.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],r=!0,a=1;a<n.length;a++){var i=n[a];0!==o[i]&&(r=!1)}r&&(s.splice(t--,1),e=u(u.s=n[0]))}return e}var r={},a={index:0},o={index:0},s=[];function i(e){return u.p+"assets/js/"+({}[e]||e)+"."+{"chunk-1327ea9b":"146ee519","chunk-2d0b91da":"de9569d3","chunk-2d0e4a43":"6d9ed5ab","chunk-2d21a3d2":"304e1b05","chunk-2d22d746":"6568c3cd","chunk-2e741e34":"83e83a30","chunk-2ea8d00e":"01740797","chunk-584c8fd5":"35396325","chunk-9016365c":"03f8bb1e","chunk-0abef5fc":"c486ed74","chunk-7f5582a0":"80a4f00f"}[e]+".js"}function u(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.e=function(e){var t=[],n={"chunk-2e741e34":1,"chunk-2ea8d00e":1,"chunk-584c8fd5":1,"chunk-9016365c":1,"chunk-0abef5fc":1,"chunk-7f5582a0":1};a[e]?t.push(a[e]):0!==a[e]&&n[e]&&t.push(a[e]=new Promise((function(t,n){for(var r="assets/css/"+({}[e]||e)+"."+{"chunk-1327ea9b":"31d6cfe0","chunk-2d0b91da":"31d6cfe0","chunk-2d0e4a43":"31d6cfe0","chunk-2d21a3d2":"31d6cfe0","chunk-2d22d746":"31d6cfe0","chunk-2e741e34":"7a34af9c","chunk-2ea8d00e":"99eef073","chunk-584c8fd5":"c6cc4761","chunk-9016365c":"5045929c","chunk-0abef5fc":"062886e8","chunk-7f5582a0":"5eb39882"}[e]+".css",o=u.p+r,s=document.getElementsByTagName("link"),i=0;i<s.length;i++){var c=s[i],l=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(l===r||l===o))return t()}var d=document.getElementsByTagName("style");for(i=0;i<d.length;i++){c=d[i],l=c.getAttribute("data-href");if(l===r||l===o)return t()}var m=document.createElement("link");m.rel="stylesheet",m.type="text/css",m.onload=t,m.onerror=function(t){var r=t&&t.target&&t.target.src||o,s=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");s.code="CSS_CHUNK_LOAD_FAILED",s.request=r,delete a[e],m.parentNode.removeChild(m),n(s)},m.href=o;var p=document.getElementsByTagName("head")[0];p.appendChild(m)})).then((function(){a[e]=0})));var r=o[e];if(0!==r)if(r)t.push(r[2]);else{var s=new Promise((function(t,n){r=o[e]=[t,n]}));t.push(r[2]=s);var c,l=document.createElement("script");l.charset="utf-8",l.timeout=120,u.nc&&l.setAttribute("nonce",u.nc),l.src=i(e);var d=new Error;c=function(t){l.onerror=l.onload=null,clearTimeout(m);var n=o[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;d.message="Loading chunk "+e+" failed.\n("+r+": "+a+")",d.name="ChunkLoadError",d.type=r,d.request=a,n[1](d)}o[e]=void 0}};var m=setTimeout((function(){c({type:"timeout",target:l})}),12e4);l.onerror=l.onload=c,document.head.appendChild(l)}return Promise.all(t)},u.m=e,u.c=r,u.d=function(e,t,n){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},u.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,t){if(1&t&&(e=u(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)u.d(n,r,function(t){return e[t]}.bind(null,r));return n},u.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="/fotocage/",u.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var d=0;d<c.length;d++)t(c[d]);var m=l;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"10c1":function(e,t,n){},"2bd0":function(e,t,n){"use strict";n("10c1")},"365c":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return c}));var r=n("bc3a");const a=r["a"].create({baseURL:"/api"}),o=(e,t,n)=>{a.put("/upload/image",e,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:t}).then(e=>{n(e)}).catch(e=>{console.log("ERROR",e)})},s=e=>{a.get("/images").then(t=>{var n;let r=null===(n=t.data)||void 0===n?void 0:n.images;r.length||(r=[]),e(r)}).catch(t=>{e({error:!0}),console.log(t)})},i=(e,t)=>{a.post("/login",{...e}).then(e=>{e.data.status?t({user:e.data.user}):t({error:!0})}).catch(e=>console.log(e))},u=(e,t)=>{a.post("/registration",{...e}).then(e=>{e.data.status?t({id:e.data.user.id,auth:e.data.user.auth,role:e.data.user.role,timeStampSession:e.data.user.timeStampSession}):t({error:!0})}).catch(e=>console.log(e))},c=(e,t)=>{a.get(`/auth/${e.id}/status`).then(e=>{e.data.session?t({id:e.data.user.id,auth:e.data.user.auth,role:e.data.user.role,timeStampSession:e.data.user.timeStampSession}):t(e.data.session)}).catch(e=>console.log(e))}},"3be0":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("f89a"),n("6672"),n("3be0");var r=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},o=[],s={name:"App",created(){this.axios.get("/api/list/users",{params:{count:5}}).then(e=>{console.info(e.data.users)})}},i=s,u=(n("2bd0"),n("2877")),c=Object(u["a"])(i,a,o,!1,null,"593d9d50",null),l=c.exports,d=n("130e"),m=n("bc3a"),p=n("4fc9"),h=n.n(p),f=n("8c4f"),g=(n("9dfb"),n("6d11")),b=n.n(g);const v=function(e,t,n){e.name&&b.a.start(),n()},S=(e,t)=>{r["a"].nextTick(()=>{document.title=e.meta.title||""}),b.a.done()};var y=n("2f62"),k=n("365c");n("14d9");const w=(e,t)=>{const n=[],r=()=>!!e;return r()?(t.some(t=>{if(!Object.prototype.hasOwnProperty.call(t,"meta")&&t.children&&w(t.children),t.meta){const r=t.meta.permissions;Array.isArray(r)&&r&&r.forEach(r=>{r.role===e&&t.meta.visibleAccess&&n.push({title:t.meta.title,name:t.name,icon:t.name})})}}),n):n};var O=w;const E={state:{isLoggedIn:!!JSON.parse(localStorage.getItem("loggin")),images:[],userId:JSON.parse(localStorage.getItem("id"))||null,role:localStorage.getItem("role")||"guest",timeStampSession:localStorage.getItem("timeStampSession")||null},mutations:{setLogin(e,{id:t,auth:n,role:r,timeStampSession:a}){e.isLoggedIn=n,e.userId=t,e.role=r,e.timeStampSession=a,localStorage.setItem("loggin",n),localStorage.setItem("id",t),localStorage.setItem("role",r),localStorage.setItem("timeStampSession",a)},setRoutes(e,t){e.routesMenu=t}},actions:{updateStatusLogin({commit:e},t){e("setLogin",t)},refreshSession({state:e,commit:t,dispatch:n}){return new Promise((r,a)=>{Object(k["e"])({id:e.userId},e=>{e?t("setLogin",e):n("logout"),r(!!e)})})},logout({commit:e},t=!1){return new Promise((n,r)=>{e("setLogin",{auth:!1,id:null,role:"guest",timeStampSession:null}),n(!t)})}},getters:{routesAccessByUser(e){const t=B[0].children;return O(e.role,t)}},modules:{}};r["a"].use(y["a"]);var L=new y["a"].Store(E);const N=()=>!!L.state.isLoggedIn,P=({redirect:e})=>{N()?L.dispatch("refreshSession").then(t=>{t?e():e({name:"Login"})}):N()||e({name:"Login"})};var T=P;const I=()=>!!L.state.isLoggedIn,A=async({redirect:e})=>{I()&&e({name:"Home"})};var j=A;const R=()=>n.e("chunk-584c8fd5").then(n.bind(null,"9be7")),x=()=>n.e("chunk-1327ea9b").then(n.bind(null,"33e2")),C=()=>n.e("chunk-2d0b91da").then(n.bind(null,"3227")),U={path:"/",component:R,children:[{path:"",name:"Home",alias:"/gallery",redirect:{name:"Gallery"},component:()=>n.e("chunk-2d21a3d2").then(n.bind(null,"bb51"))},{path:"upload",name:"Upload",component:()=>n.e("chunk-2ea8d00e").then(n.bind(null,"8970")),meta:{title:"Upload",visibleAccess:!0,middleware:{attach:[T]},permissions:[{role:"photographer",access:!0},{role:"admin",access:!0}]}},{path:"gallery",name:"Gallery",component:()=>n.e("chunk-2e741e34").then(n.bind(null,"9772")),meta:{title:"Gallery",visibleAccess:!0,middleware:{attach:[T]},permissions:[{role:"photographer",access:!0},{role:"admin",access:!0},{role:"guest",access:!1}]}},{path:"about",name:"About",component:()=>n.e("chunk-2d22d746").then(n.bind(null,"f820")),meta:{title:"About",visibleAccess:!1,middleware:{attach:[T]},permissions:[{role:"photographer",access:!0},{role:"admin",access:!0}]}}]},q={path:"/auth",name:"Auth",component:x,redirect:{name:"Login"},children:[{path:"registration",name:"Registration",component:()=>Promise.all([n.e("chunk-9016365c"),n.e("chunk-7f5582a0")]).then(n.bind(null,"b973")),meta:{title:"Registration",middleware:{attach:[j],ignore:[T]}}},{path:"login",name:"Login",component:()=>Promise.all([n.e("chunk-9016365c"),n.e("chunk-0abef5fc")]).then(n.bind(null,"d9c9")),meta:{title:"Login",middleware:{attach:[j],ignore:[T]}}}]},M={path:"/*",component:C,redirect:{name:"Error-Not-Found"},middleware:{ignore:[T]},children:[{path:"page-not-found",name:"Error-Not-Found",component:()=>n.e("chunk-2d0e4a43").then(n.bind(null,"90a7"))}]},B=[U,q,M];r["a"].use(f["a"]);const _={mode:"history",base:"/fotocage/",routes:B},D=new f["a"](_);D.beforeEach(v),D.afterEach(S);var J=D,W=n("0c6e"),z=function(){this.namespace="api",this.post("/login",(e,t)=>{const n=JSON.parse(t.requestBody),r=e.users.findBy({login:n.login,password:n.password});return r?(r.update({auth:!0,timeStampSession:Date.now()}),console.log("[SERVER]: Loggin user - ",String(r.login)),{status:!0,user:{id:Number(r.id),login:String(r.login),auth:r.id>0,role:r.role,timeStampSession:Date.now()}}):new W["c"](401,{some:"header"},{status:!0,user:{id:null,auth:!1}})}),this.post("/registration",(e,t)=>{const n=JSON.parse(t.requestBody),r=e.users.create({login:n.login,password:n.password,auth:!1,role:"guest",timeStampSession:Date.now()});return r?(r.update({auth:!0}),console.log("[SERVER]: New user - ",String(r.login)),{status:!0,user:{id:Number(r.id),login:String(r.login),auth:r.id>0,role:r.role,timeStampSession:Date.now()}}):new W["c"](401,{some:"header"},{status:!0,user:{id:null,auth:!1}})}),this.get("/auth/:userId/status",(e,t)=>{const n=e.users.find(t.params.userId),r=Date.now(),a=9e5,o=n.timeStampSession,s=r-o,i=()=>!!o,u=()=>!!n;return u()&&(s>a||i())?(n.update({auth:!0,timeStampSession:r}),{session:!0,user:{id:Number(n.id),login:String(n.login),auth:n.id>0,role:n.role,timeStampSession:r}}):{session:!1,user:{id:null,auth:!1}}}),this.put("/upload/image",(e,t)=>{const n=JSON.parse(t.requestBody);return console.log("[SERVER UPLOAD]: ",n),e.images.create({src:n.src,title:n.title,filename:n.name,description:n.description}),{status:!0}}),this.get("/images",(e,t)=>{const n=e.images.all();return n}),this.get("/list/users",(e,t)=>{const n=e.users.all();if(t.queryParams.count){const e=t.queryParams.count;return n.slice(0,e)}return n})},H=n("8387");const F={user:W["b"]},G={user:W["a"].extend({name(){return H["a"].name.middleName()},email(){return H["a"].internet.email()},login(){return H["a"].name.firstName()},password(){return H["a"].internet.password()},auth(){return!1}})},V={image:W["b"]},$={image:W["a"].extend({src(){return H["a"].image.image()},filename(){return H["a"].name.jobTitle()+".jpg"},title(){return H["a"].name.jobTitle()},description(){return H["a"].lorem.words()}})};function K(e="development"){const t=Object(W["d"])({models:{user:F.user,image:V.image},factories:{user:G.user,image:$.image},environment:e,routes:z,seeds(e){e.createList("user",2,{role:"photographer"}),e.createList("user",3,{role:"reader"}),e.create("user",{name:H["a"].name.middleName(),email:H["a"].internet.email(),login:"Test",password:"test",auth:!1,role:"admin"}),e.create("user",{name:H["a"].name.middleName(),email:H["a"].internet.email(),login:"Test2",password:"test2",auth:!1,role:"guest"}),e.create("user",{name:H["a"].name.middleName(),email:H["a"].internet.email(),login:"Test3",password:"test3",auth:!1,role:"photographer"}),e.createList("image",25)}});return t}r["a"].use(h.a,J),r["a"].use(d["a"],m["a"]),K();t["default"]=new r["a"]({router:J,store:L,render:e=>e(l)}).$mount("#app")},6672:function(e,t,n){},"6d11":function(e,t,n){var r,a;n("14d9"),function(o,s){r=s,a="function"===typeof r?r.call(t,n,t,e):r,void 0===a||(e.exports=a)}(0,(function(){var e={version:"0.2.0"},t=e.settings={minimum:.08,easing:"ease",positionUsing:"",speed:200,trickle:!0,trickleRate:.02,trickleSpeed:800,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'\n      <div class="bar" role="bar">\n        <div class="peg"></div>\n      </div>\n      <div class="spinner" role="spinner">\n        <div class="spinner-icon"></div>\n      </div>'};function n(e,t,n){return e<t?t:e>n?n:e}function r(e){return 100*(-1+e)}function a(e,n,a){var o;return o="translate3d"===t.positionUsing?{transform:"translate3d("+r(e)+"%,0,0)"}:"translate"===t.positionUsing?{transform:"translate("+r(e)+"%,0)"}:{"margin-left":r(e)+"%"},o.transition="all "+n+"ms "+a,o}e.configure=function(e){var n,r;for(n in e)r=e[n],void 0!==r&&e.hasOwnProperty(n)&&(t[n]=r);return this},e.status=null,e.set=function(r){var i=e.isStarted();r=n(r,t.minimum,1),e.status=1===r?null:r;var u=e.render(!i),c=u.querySelector(t.barSelector),l=t.speed,d=t.easing;return u.offsetWidth,o((function(n){""===t.positionUsing&&(t.positionUsing=e.getPositioningCSS()),s(c,a(r,l,d)),1===r?(s(u,{transition:"none",opacity:1}),u.offsetWidth,setTimeout((function(){s(u,{transition:"all "+l+"ms linear",opacity:0}),setTimeout((function(){e.remove(),n()}),l)}),l)):setTimeout(n,l)})),this},e.isStarted=function(){return"number"===typeof e.status},e.start=function(){e.status||e.set(0);var n=function(){setTimeout((function(){e.status&&(e.trickle(),n())}),t.trickleSpeed)};return t.trickle&&n(),this},e.done=function(t){return t||e.status?e.inc(.3+.5*Math.random()).set(1):this},e.inc=function(t){var r=e.status;return r?("number"!==typeof t&&(t=(1-r)*n(Math.random()*r,.1,.95)),r=n(r+t,0,.994),e.set(r)):e.start()},e.trickle=function(){return e.inc(Math.random()*t.trickleRate)},function(){var t=0,n=0;e.promise=function(r){return r&&"resolved"!==r.state()?(0===n&&e.start(),t++,n++,r.always((function(){n--,0===n?(t=0,e.done()):e.set((t-n)/t)})),this):this}}(),e.render=function(n){if(e.isRendered())return document.getElementById("nprogress");u(document.documentElement,"nprogress-busy");var a=document.createElement("div");a.id="nprogress",a.innerHTML=t.template;var o,i=a.querySelector(t.barSelector),c=n?"-100":r(e.status||0),l=document.querySelector(t.parent);return s(i,{transition:"all 0 linear",transform:"translate3d("+c+"%,0,0)"}),t.showSpinner||(o=a.querySelector(t.spinnerSelector),o&&d(o)),l!=document.body&&u(l,"nprogress-custom-parent"),l.appendChild(a),a},e.remove=function(){c(document.documentElement,"nprogress-busy"),c(document.querySelector(t.parent),"nprogress-custom-parent");var e=document.getElementById("nprogress");e&&d(e)},e.isRendered=function(){return!!document.getElementById("nprogress")},e.getPositioningCSS=function(){var e=document.body.style,t="WebkitTransform"in e?"Webkit":"MozTransform"in e?"Moz":"msTransform"in e?"ms":"OTransform"in e?"O":"";return t+"Perspective"in e?"translate3d":t+"Transform"in e?"translate":"margin"};var o=function(){var e=[];function t(){var n=e.shift();n&&n(t)}return function(n){e.push(n),1==e.length&&t()}}(),s=function(){var e=["Webkit","O","Moz","ms"],t={};function n(e){return e.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,(function(e,t){return t.toUpperCase()}))}function r(t){var n=document.body.style;if(t in n)return t;var r,a=e.length,o=t.charAt(0).toUpperCase()+t.slice(1);while(a--)if(r=e[a]+o,r in n)return r;return t}function a(e){return e=n(e),t[e]||(t[e]=r(e))}function o(e,t,n){t=a(t),e.style[t]=n}return function(e,t){var n,r,a=arguments;if(2==a.length)for(n in t)r=t[n],void 0!==r&&t.hasOwnProperty(n)&&o(e,n,r);else o(e,a[1],a[2])}}();function i(e,t){var n="string"==typeof e?e:l(e);return n.indexOf(" "+t+" ")>=0}function u(e,t){var n=l(e),r=n+t;i(n,t)||(e.className=r.substring(1))}function c(e,t){var n,r=l(e);i(e,t)&&(n=r.replace(" "+t+" "," "),e.className=n.substring(1,n.length-1))}function l(e){return(" "+(e.className||"")+" ").replace(/\s+/gi," ")}function d(e){e&&e.parentNode&&e.parentNode.removeChild(e)}return e}))},"9dfb":function(e,t,n){},f89a:function(e,t,n){}});